define(['jquery'],function($){'use strict';$.widget('mage.customPopupByCookie',{options:{},_create:function(){this._initAllVars();this._bindEvents();},_initAllVars:function(){let baseCookieName=window.countryPopupConfig.baseCookieName,allCountryList=window.countryPopupConfig.allCountryTextList,hadPopupCookieName=window.countryPopupConfig.hadPopupCookieName,localCountry=window.countryPopupConfig.localCountry,hadShowPopAgain=0,needPopup=0,countryCookie=this._getCustomCookie(baseCookieName);countryCookie=this._resolveRightCookie(allCountryList,countryCookie);if(countryCookie){hadPopupCookieName+='_'+countryCookie;hadShowPopAgain=this._getCustomCookie(hadPopupCookieName);}
needPopup=!hadShowPopAgain;if(countryCookie&&countryCookie.indexOf(localCountry)>=0){needPopup=0;}
const topNavigateObj=$('#topNavigate'),bodyGlobal=$('body');let overflowOption=bodyGlobal.css('overflow');if(!overflowOption){overflowOption='auto';}
this.options.viewAllLink=window.countryPopupConfig.viewAllLink;this.options.hadPopupCookieName=hadPopupCookieName;this.options.navigateUrl='';this.options.bodyScrollOverflow=overflowOption;if(countryCookie&&needPopup){let description=allCountryList[countryCookie]['description'],navigateButtonText=allCountryList[countryCookie]['navigateButtonText'];this.options.navigateUrl=allCountryList[countryCookie]['navigateUrl'];$('#navigateButton').html(navigateButtonText);$('#description').html(description);topNavigateObj.show();bodyGlobal.css('overflow','hidden');}},_writePopupCookie:function(){let hadPopupCookieName=this.options.hadPopupCookieName;this._setCustomCookie(hadPopupCookieName,'1',10*365);},_bindEvents:function(){let obj=this;$('.StayHere').on('click',function(e){obj._writePopupCookie();$('body').css('overflow',obj.options.bodyScrollOverflow);$('#topNavigate').hide();});$('.view-all-link').on('click',function(e){obj._writePopupCookie();location.href=obj.options.viewAllLink;});$('.NewNavigate').on('click',function(e){obj._writePopupCookie();location.href=obj.options.navigateUrl;});},_resolveRightCookie:function(allCountryText,countryCookie){if(!allCountryText||!countryCookie){return false;}
countryCookie=countryCookie.toLowerCase();if(allCountryText.hasOwnProperty(countryCookie)){return countryCookie;}
const country=countryCookie.split('-')[0];for(const cookieIndex in allCountryText){if(cookieIndex.indexOf(country)===0){return cookieIndex;}}
return false;},_setCustomCookie:function(cname,cvalue,exdays){let d=new Date(),expires;d.setTime(d.getTime()+exdays*24*60*60*1000);expires='expires='+d.toUTCString();document.cookie=cname+'='+cvalue+'; '+expires+';path=/';},_getCustomCookie:function(cname){const name=cname+'=',ca=document.cookie.split(';');for(let i=0;i<ca.length;i++){let c=ca[i];while(c.charAt(0)===' '){c=c.substring(1);}
if(c.indexOf(name)===0){return c.substring(name.length,c.length);}}
return'';}});return $.mage.customPopupByCookie;});