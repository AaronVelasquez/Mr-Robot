define(["jquery"],function($){"use strict";return{separator:'=',isSeoFriendly:true,categoryUrlSufix:'',getManualUrl:function(options,url){var self=this;Object.keys(options).sort().forEach(function(request,i){var params=options[request];params.sort();if(self.isSeoFriendly){$.each(params,function(key,value){url=self.getUrl(request,value,null,url);});}else{var value=params.join(',');url=self.getUrl(request,value,null,url);}});return url;},beforeProcess:function(url){if(this.isSeoFriendly){url=url.replace(this.categoryUrlSufix,'');var p=url.indexOf('?');if(p>0){url=url.substr(0,p)+this.categoryUrlSufix+url.substr(p);}else{url+=this.categoryUrlSufix;}}
return url;},removePriceFromUrl:function(url){var priceFilters=url.match(/(\/price-[a-z0-9_.]+)/g);if(priceFilters){priceFilters=jQuery.unique(priceFilters);if(priceFilters.length>1){for(var i=0;i<priceFilters.length-1;i++){url=url.replace(priceFilters[i],'');}}}
return url;},getCurrentUrl:function(){return window.location.href.replace(window.location.search,'');},isParams:function(){return window.location.search.length;},getParamsFromUrl:function(){var query=location.search.substr(1);var result={};if(query){query.split("&").forEach(function(part){var item=part.split("=");result[item[0]]=[];var params=decodeURIComponent(item[1]).split(',');params.forEach(function(param){result[item[0]].push(param);});});}
return result;},convertValue:function(val){val=val.toLowerCase();val=val.replace('-','_');val=val.replace(' ','_');return val;},param:function(a){var self=this;var prefix,s=[],add=function(key,value){value=$.isFunction(value)?value():(value==null?"":value);s[s.length]=encodeURIComponent(key)+self.separator+encodeURIComponent(value);};$.each(a,function(name,value){add(name,value);});var joinParam=self.isSeoFriendly?'/':'&';return s.join(joinParam).replace("/%20/g","+");},getUrl:function(pName,pValue,defValue,url,remove){if(typeof pName=='undefined'){return url;}
if(typeof url=='undefined'){var urlPaths=document.location.href.split('?');}else{var urlPaths=url.split('?');}
var pathname=urlPaths[0];var decode=window.decodeURIComponent;if(!this.isSeoFriendly){var urlParams=urlPaths[1]?urlPaths[1].split('&'):[];}else{var _urlParams=pathname.split('/')
urlParams=[];for(var i=_urlParams.length-1;i>0;i--){if(_urlParams[i].search(this.separator)>0){if(!pathname.search(_urlParams[i]))
urlParams.push(_urlParams[i]);}else{break;}}}
var pData={},baseUrl=urlPaths[0],parameters;var _separator=this.isSeoFriendly?this.separator:'=';for(var i=0;i<urlParams.length;i++){parameters=urlParams[i].split(_separator);var val='';if(parameters[1]!==undefined){try{val=decode(parameters[1].replace(/\+/g,'%20'));}catch(e){val=unescape(parameters[1].replace(/\+/g,'%20'));}}
pData[decode(parameters[0])]=val;}
pData[pName]=pValue;if(pData&&typeof(pData['origin'])!=='undefined'){var originVal=pData['origin'];delete pData['origin'];pData['origin']=originVal;}
pData=this.param(pData);if(this.isSeoFriendly){if(remove){var regex=new RegExp("(\/"+pName+"-[a-z0-9]+)");baseUrl=baseUrl.replace(regex,"");}
baseUrl=baseUrl.replace("/"+pName+'-'+pValue,"");var slash=pathname[pathname.length-1]!='/'?'/':'';var actionUrl=baseUrl+(pData.length?slash+pData:'');actionUrl+=urlPaths[1]?'?'+urlPaths[1]:'';}else{var actionUrl=baseUrl+(pData.length?'?'+pData:'');}
return actionUrl;},genUrl:function(pName,pValue,type,checked,url){if(typeof pName=='undefined'){return url;}
if(!pValue){return url;}
var urlPaths;if(typeof url=='undefined'){urlPaths=document.location.href.split('?');}else{urlPaths=url.split('?');}
var decode=window.decodeURIComponent,encode=window.encodeURIComponent,urlParams=urlPaths[1]?urlPaths[1].split('&'):[],pData={},baseUrl=urlPaths[0],parameters,pNameLength=0;for(var i=0;i<urlParams.length;i++){parameters=urlParams[i].split(this.separator);var key=decode(parameters[0]).replace(/\[\d?\]$/,'');if(key==='p'){continue;}
var val='';if(parameters[1]!==undefined){try{val=decode(parameters[1].replace(/\+/g,'%20'));}catch(e){val=unescape(parameters[1].replace(/\+/g,'%20'));}}
var oldVal=pData[key];if(oldVal){if($.isArray(oldVal)){pData[key].push(val);}else{pData[key]=[oldVal,val];}}else{pData[key]=val;}}
switch(type){case'single':if(checked){pData[pName]=pValue;}else{pData.hasOwnProperty(pName)&&delete pData[pName];}
break;case'multiple':default:if(pData.hasOwnProperty(pName)){if($.isArray(pData[pName])){var index=$.inArray(pValue,pData[pName]);if(checked){if(index===-1){pNameLength=pData[pName].length;pData[pName][pNameLength]=pValue;}}else{if(index!==-1){pData[pName].splice(index,1);pNameLength=pData[pName].length;if(!pNameLength){delete pData[pName];}
if(pNameLength===1){pData[pName]=pData[pName].pop();}}}}else{if(checked){if(pData[pName]!==pValue){var temp=pData[pName];pData[pName]=[temp,pValue];}}else{if(pData[pName]===pValue){delete pData[pName];}}}}else{pData[pName]=pValue;}
break;}
var s=[],self=this;if(pData&&typeof(pData['origin'])!=='undefined'){var originVal=pData['origin'];delete pData['origin'];pData['origin']=originVal;}
$.each(pData,function(name,value){if($.isArray(value)){$.each(value,function(key,val){s[s.length]=encode(name+'[]')+self.separator+encode(val);})}else{s[s.length]=encode(name)+self.separator+encode(value);}});pData=s.join('&').replace("/%20/g","+");return baseUrl+(pData.length?'?'+pData:'');},getValueByKey:function(url,key){var urlPaths;if(typeof url=='undefined'){urlPaths=document.location.href.split('?');}else{urlPaths=url.split('?');}
var urlParams=urlPaths[1]?urlPaths[1].split('&'):[];var urlMap=new Map();for(const urlParam of urlParams){var array=urlParam.split('=');urlMap[array[0]]=array[1];}
return urlMap[key]||'';}}});