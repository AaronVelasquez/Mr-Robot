define(["jquery","HPOLS_Elasticsearch/js/model/url",'HPOLS_Elasticsearch/js/model/processor','HPOLS_Elasticsearch/js/product/list/toolbar',"domReady!"],function($,url,processor,toolbar){'use strict';return function(targetWidget){$.widget('elasticsearch.productfilter',targetWidget,{_create:function(){if(this.options.filterItemSelector){var self=this;url.separator=this.options.filterParamSeparator;url.isSeoFriendly=this.options.isSeoFriendly;url.categoryUrlSufix=this.options.categoryUrlSufix;toolbar.rewrite();processor.init(this);if(this.options.auto){$(this.options.filterItemSelector).on('click',$.proxy(this._run,this));}else{$(this.options.filterItemSelector).on('click',$.proxy(this._add,this));}
$(this.options.actionsSelector).on('click',$.proxy(this._selectPageAction,this));$(this.options.limiterSelector).on('change',$.proxy(this._limiterOptionsAction,this));$(this.options.priceSelector).on('click',$.proxy(this._priceAction,this));$(this.options.clearButton).on('click',$.proxy(this._clearAction,this));$(this.options.removeFilterLink).on('click',$.proxy(this._removeItemAction,this));var containerCollapsible=$(self.options.filterSelector).find('[data-role="collapsible"]');if($('body').hasClass('ppf-pos-toolbar')){$(document).on('mouseup',function(e){if(!containerCollapsible.is(e.target)&&containerCollapsible.has(e.target).length===0){try{containerCollapsible.collapsible('deactivate');}catch(e){}}});}}}});return $.elasticsearch.productfilter;}})